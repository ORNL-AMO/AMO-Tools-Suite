language: cpp
compiler:
  - gcc
os: 
  - linux
  - osx
addons:
  apt:
    sources:
      - ubuntu-toolchain-r-test
      - g++-7

before_install:
  - if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then
    brew update;
    brew install doxygen;

    else
    sudo apt-get update;
    sudo apt-get install doxygen;
    curl -sL https://deb.nodesource.com/setup_10.x | sudo -E bash -;
    sudo apt-get install -y nodejs;
    fi

install: travis_retry npm install

script:
  - export CC=gcc-7
  - export CXX=g++-7
  - cmake --version
  - cmake ./
  - make
  - ./bin/amo_tools_suite_tests
  - npm install
  - npm run test
  - doxygen Doxyfile.in
